<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">


  
  <title>Michi Box-Card Game</title>
  
  <!-- Estilos -->
  <link rel="stylesheet" type="text/css" href="style/normalize.css" />
  <link rel="stylesheet" type="text/css" href="style/style.css" />
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Covered+By+Your+Grace&display=swap" rel="stylesheet">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#5c1a7e">
  <link rel="icon" type="image/png" href="/assets/icon-192.png">   

  <!-- Librerías externas -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<body class="indexbackground">
<main>

 
<div class="pantallacargando" style="  animation: cargando 5s !important;">
   <div class="spinner"></div>
   <div class="logospinner"></div>
</div>


  <!------------------------BANNER PRESENTACION------------------------------------->
  <div class="contenedor">
    <div class="logo lazy-michi">
      <DIV class="IMAGENLOGOBANNER lazy-michi"></DIV>
    </div>
<div class="CONTENEDORESBOTONESMENU">
      <div class="botonesmenu">
      <a onclick="mostrarGaleria()" class="iconomenu lazy-michi" style="background-image: url(./assets/galeriacartasicon.webp);"></a>
      <a onclick="mostrarQuees()" class="iconomenu lazy-michi" style="background-image: url(./assets/boton_QUE_ES.webp);"></a>
      <a onclick="mostrarNoticias()" class="iconomenu lazy-michi" style="background-image: url(./assets/boton_NOTICIAS.webp);"></a>
      <a onclick="mostrarRegalos()" class="iconomenu lazy-michi" style="background-image: url(./assets/boton_tienda.webp);"></a>

    </div>
</div>
<DIV class="infoandroid" data-lazy="true"></DIV>

  <button id="installBtn" class="botondescargarapp"> 
    <p>DESCARGAR APP</p>
    <img src="./assets/icon-192.png" alt="">
  </button>


    <p class="descripcionbanner">MICHI BOX - Juego de gatos coleccionables V2.0.5. Proyectual Digitalización Cat.Gramajo I 2025. diseño y realización: José Ignacio Pyptyk</p>
  </div>
  <!------------------------------------------------------------------------>


    <!------------------------galeria html------------------------------------>
  <div id="galeriaContainer">
    <iframe id="iframeGaleria" src="galeria.html" style="width: 100%; height: 100%; border: none;"></iframe>
  </div>

  <!------------------------------------------------------------------------>

      <!------------------------QUE ES? html------------------------------------>
  <div id="queesContainer" >
    <iframe src="quees.html" style="width: 100%; height: 100%; border: none;"></iframe>
  </div>

  <!------------------------------------------------------------------------>


        <!------------------------NOTICIAS html------------------------------------>
  <div id="noticiasContainer" >
    <iframe src="noticias.html" style="width: 100%; height: 100%; border: none;"></iframe>
  </div>

  <!-----------------------------------REGALOS HTML------------------------------------->
    <div id="regalosContainer" >
    <iframe src="regalos.html" style="width: 100%; height: 100%; border: none;"></iframe>
  </div>

</main>



<!-- Scripts al final para que cargue todo el DOM primero -->
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/service-worker.js')
      .then(reg => console.log('Service Worker registrado:', reg.scope))
      .catch(err => console.error('Service Worker registro falló:', err));
  }


  let deferredPrompt = null;

  // Función para detectar si estamos en PWA instalada
  function isAppInstalled() {
    return window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true;
  }

  // Función para ocultar o mostrar el botón
  function actualizarBotonInstalacion() {
    const btn = document.getElementById("installBtn");
    if (!btn) return;

    if (isAppInstalled()) {
      btn.style.display = "none"; // Oculta si ya está instalada
    } else if (deferredPrompt) {
      btn.style.display = "block"; // Muestra si es posible instalar
    }
  }

  // Detectar evento antes de instalación
  window.addEventListener("beforeinstallprompt", (e) => {
    e.preventDefault(); // Evita el banner automático
    deferredPrompt = e;
    actualizarBotonInstalacion();
  });

  // Manejo del clic en el botón
  document.addEventListener("click", async (e) => {
    const btn = document.getElementById("installBtn");
    if (!btn || e.target !== btn) return;
    if (!deferredPrompt) return;

    deferredPrompt.prompt();
    const result = await deferredPrompt.userChoice;
    console.log("Instalación:", result.outcome);

    if (result.outcome === "accepted") {
      console.log("✅ App instalada");
      btn.style.display = "none";
    }

    deferredPrompt = null;
  });

  // Revisar instalación cada vez que se vuelve a la página
  document.addEventListener("visibilitychange", actualizarBotonInstalacion);

  // Llamada inicial al cargar la página
  document.addEventListener("DOMContentLoaded", actualizarBotonInstalacion);
</script>

<script src="sketch/sketch.js"></script>
</body>
</html>
